榎田先輩

1序論
1.1研究背景
近年、物流業界の人手不足が深刻化し、大きな社会問題となっている。この問題を解消
するために、自律移動ロボットに関する研究が活発に行われている。我が国の経済・国民
生活を支える社会インフラの物流には、
「物流の2024年問題」だけでなく、構造的な需給
逼迫による輸送力不足の危機が迫っている［。これにより、労働力不足による物流需要が
さらに逼迫する可能性がある。このような背景から物流の労働力を補うための自動配送口
ボットを社会実装が強く望まれている。ただし、社会実装を実現するためには、未知環境
で動作する場合や未知障害物に対して安全かつ安定した経路生成を行う必要がある．特に
動的障害物を考慮した経路生成をするためには動的障書物を検出し、障書物の移動を予測
する必要がある。
移動ロボットが障告物を回避する手法として、大域的経路計画に基づく方法があるが算
出された経路が曲がり角などで障害物に近づきすぎるという問題がある12）、他にも経路生
成には、ニューラルネットワークを導入した方法がある13。しかし、経路を高速で生成する
ことができる反面，大量のデータを事前に学習させる必要があるため学習環境下によって
は経路が変化した際に対応することができない場合があるため安定性に欠ける。また、従
来研究14］のようにロボット同士のデータを共有することで譲り合うこともできるがロボッ
トが複数台の場合や未知環境の場では動きを制御するのが難しいという問題点がある．こ
れらの手法は、経路生成を行うことは可能であるが、どれも未知障害物を未知環境で回避
する方法としてはあまり適していない。
本研究では、ポテンシャル法に動的障害物の速度予測を行う機能を組み込み、仮ゴール
を設置することによって障害物の回避を行う。ポテンシャル法15,6］とは、環境内に床力ポ
テンシャル場と引力ポテンシャル場の2つからなるの仮想ポテンシャル場を設定すること
による経路計画を行う手法である。図1に障害物による床カポテンシャル場、目的地に対
する引力ポテンシャル場からなるポテンシャル場を示す。これらのポテンシャル場にした
がいながら移動することによって、ロボットは効率的に目的地に到達することができ、計
算量も少ないという利点がある。しかし、ポテンシャル法には「停留問題」が存在する。
「停
］
障害物のポテンシャル関数
目標位置
ポテンシャル勾配
による目標経路
目標位置への
ポテンシャル勾配（誘引方向）
障害物の
ポテンシャル勾配（反発方向）
図1：ポテンシャル場の一例［10］
留問題」とは、ポテンシャル法の問題点である障害物の床力と目的地の引力が0に近くな
ることによって、その地点に停滞し、目的地に到着することが困難になることである［0］。
従来研究［7～19では、ポテンシャル場の勾配ベクトルに沿ってロボットを移動させるこ
とを考えている、特に従来研究［9では、停留した際に障害物の向こう側に仮ゴールをA*
探索法を用いて設定することによって、
「停留問題」を解決することに成功している。この
ことから静的障害物の回避については研究が進んでいることがわかる。しかし、従来研究
［7）～［9に動的障害物の回避を行わせた場合，ロボットは障害物に対して追従・衝突してし
まうことがある。そのため、未知環境や未知障物の回避をするためにも動的障書物も考
慮する必要がある。以上のことより、本研究では動的障書物を回避する手法を従来研究（7］
をもとに新たに提案する。
2
1.2研究目的
本研究では、従来研究18」をもとにポテンシャル法に障書物の速度予測機能を組み込んだ
動的障害物の回避手法を提案する、また、従来手法【8】と切り替えるタイミングを考え、セ
ンサの値を従来手法「8」と提案手法で変更することにより、静的障害物・動的障物の両方
を安全に回避することを目指す。具体的には、障害物座標の変化から障害物の速度を計算
することで、＋ステップ後の障害物の予測を行う。さらに、仮ゴールを障書物の進行方向以
外に設置することによって、障害物の進行方向にロボットが侵入することを防ぐ、本論文
では、提案する動的障害物回避手法を示し、シミュレーションを通じて提案手法の有用性
を検証する。










2従来研究
2.1ポテンシャル場の勾配
従来研究17では、障害物から発生する斥力ポテンシャル場、目的地から発生する引力ポ
テンシャル場、及び全体のポテンシャル場を次式のように定めている。
・障害物座標の力ポテンシャル関数Po（&r,3）
1
Pob（arsy）＝（1）
V（-20）+（36-304）9
・目的地座標の引力ポテンシャル関数Pas（Ar,3/）
Pas（tr;3）＝
--
1
（2）
V（-Nds）+（30-3408）3
●全体のポテンシャル場P（r,3，）
Pro3）=woPo+WdsPas（3）
ここで、（Arッツ）はロボットの座標を示し、（Xob;306），（Xds;yas）はそれぞれ障害物の座標と日
的地の座標を表している。また，（3）式のwob,Wdsはどちらも正の実数の重み付けパラメー
タであり、それぞれ引カポテンシャル関数Pa（ar,3）と床力ポテンシャル関数P。（ar）3）の
重みとなっている。ただし、Wobを大きくしてしまうと障害物の斥力から受ける影響が強ま
り、目的地への到着が難しくなる可能性があるためwo＜wasとする。ロボットの動く方
向は、ポテンシャル場の勾配によって決められ、2方向方向における勾配は次式のよう
に求められる。
●・方向の勾配
OPob（tr,y，）
=
дх
じゅーtob
（4）
｛（-#06）+（4-306）71（27-30）+（37-306）3
4
OPds(X,Yr)X,-Xds
{(X,-Xds)?+(y,-Yds)}}V(Xp-Xds)}+(y,-Yds)3
（5）
ĐP(2,34)=Ewo-aPds(X,,Yr)(6)
・y方向の勾配
Yr-Yob
1（2，-206）+（37-306）V（27-306）+（30-30）
aPds(X,Y+)Yr-Yds
{(X,-X23)"+(y,-Yds)3V(x-Xds)+(y,-yds)?
（8）
OPo(*r,yr)+wd
OPa(X,Yr)
дх
（9）
よって、ポテンシャル場内のロボット位置（r,3）における勾配7p（2rッ3）は、次式のよう
に表せる。
Vp(x,,Yr)=
地点（Xr;3，）にいるロボットは（10）式によって与えられた勾配に沿って移動する。







2.2従来研究［8］の壁沿い走行
2.2.1制御対象
従来手法18」で使用する制対象は、図2のようなロボットであり、搭載されているセン
サは前、右前、左前、左、右の合計5つである。センサの検知距離は70cm】としている。
本研究では、従来手法［8」と同じ制対象を採用するが、動的障物の近くから回避するの
は障害物・ロボットの速度によっては困難となる可能性がある。そのため本研究では、動的
5
Rb4、目的地
Ta
Rb1
30°
Rb2
Ob
Rb3
Rb5
～現在地
図2：制御対象
図3：予測線分、現在地と目的地の関係
障害物からある程度離れた距離から障害物を認識できるようにセンサの検知距離200cmn］
として設定する。このとき、検知した障害物が動的障害物ならば200lcm』のまま障害物を
回避し、静的障物ならば70cm］に検知距離を再度設定する。
2.2.2障害物の予測と壁沿い走行
障害物の予測については、ロボットに搭載している5つのセンサのうち2つのセンサが
障害物を検出した場合、その検出した2点を結ぶ直線の勾配を計算する。この勾配を基に
生成した障害物の延長を予測した線分に沿って壁沿い走行を行わせる。ただし、1つのセ
ンサのみが障害物を検知した場合は10/cm」ずつ進ませ、計30cm」前進させる。このとき、
2つのセンサが障害物を検知できなかった場合はポテンシャル法に従い目的地に向かって
走行させる。また、壁沿い走行の際の方向を決定する方法は障物予測後に現在地，目的
地の位置と予測線分の角度を用いている。図3では、障害物の予測線分を00，目的地とロ
ボットの現在地を結ぶ線分をTaとする．ObとTaのなす角日（障害物に対してなす角が大
きい方向に進行）を06の傾きa,Taの傾き6を用いて次式で与える。
=tan-1a-6
1+ab（11）
6
未知障事物～
横知した障害物の頂点
•目的地
●検知した障害物
ロポット（壁沿い走行）
①走行中に障害物の頂点を検知
●
ロポット（回り込み走行）
②回り込み走行中に新たな障害物を検知
●
ロボット（壁沿い走
③検知した障害物で壁沿い走行を行う
図4：回り込み走行中に障害物を検知した際の動作
2.2.3：障害物の裏側への回り込み走行
従来研究（7】の壁沿い走行後では、床力ポテンシャル場の影響により、障害物に対して大
きく膨らむように経路を生成してしまう場合がある、そのため、従来研究［8」では障書物
の裏側に回り込むようにし、効率的な経路生成を行うことに成功した。図4に示すように、
回り込み走行はロボットが壁沿い走行後に障害物と一定の距離を保ち、かつ円を描くよう
に進むことにより実施される。その後、ロボットが目的地に向かって進行する際にはポテ
ンシャル法を用い走行し、回り込んだ先に障害物を再度検知した場合は図4のようにび
壁沿い走行をすることにより障書物の回避を行う。







2.2.4障害物の重みパラメータ変更
従来研究17］では、ロボットが障書物を壁沿い走行で回避後も障害物を認識し続けてしま
い，斥力ポテンシャル場が変化せずに大きく遠回りしてしまう場合がある。図5のように
パラメータを変更前の経路では、ロボットが障書物の裏側に回り込んだ後に目的地の方向
を向いている場合でも障害物の影響を受け続けている、そのため、従来研究［8」では障害物
7
バイナリ占有グリッド
ハイナリ占有グリッド
12
Y[m]
Y[m]
6
-20246810
x［m］
1222024*โตป์∞1012
図5：重みパラメータを変更前
図6：重みパラメータを変更後
の重要度を示す重みパラメータを変更することで、安全で効率的な経路を作成する方法を
提案している。図5.6では、ロボットの前センサ、右前センサ、右センサが検知した場合に
ついてそれぞれ✕、口，＊で表示している。図6では、実際に回避後の障物の重みを減
らすことでより効率的な経路を生成することができる、
一方、障物の重みを減らしてしま
うと衝突の危険性が増大する可能性がある。よって、安全で効率的な経路生成のためには、
障害物の回避に影響を与えない範囲で障害物の重みを適切に下げることが必要となる。











3提案手法
従来研究17～では、静的障害物のみを対象としており、動的障害物は考慮されていな
い。実際に従来研究18.9に対して、動的障物を考慮すると図7のようになる。図7のよ
うに追従してしまう理由として、障害物の速度を考慮していないためである。そこで本研
究では、検知した動的障害物の位置情報から速度を推定し、進行方向とは逆側に仮ゴール
を作ることによって、安全かつ安定した回避を目指す。また，従来研究18に提案手法を組
み込むことで動的障害物・静的障害物を回避する手法を提案する。動的障害物にセンサが
反応したとき、動的障害物の4つの頂点位置に関する情報を入手出来るものとする。
3.1動的障害物の回避
3.1.1速度推定と動的障害物の予測
本研究では、動的障害物obmの速度（2u,3o）は次のように推定することを考え、動的障書物
の予測に用いることにする。仮ゴールの設定方法は32で説明する。ここで、（21）31），（22,32）
は障害物の左下の位置を表している.
1.センサによりobmを認識する。
2.obmから座標（21,J1）を受け取る。
9
3.1ステップ後のobm座標（22,32）を受け取る。
4.速度ob，を次式のように求める
obo=（22-11,32-31）
（12）
5.求めたob，から20ステップ後の障害物obmzを予測する。
6.予測したomzをポテンシャル場に組み込む。
7.仮ゴールを設定し、そこに向かってポテンシャル法で進行する。
8.仮ゴールに到着するか、30ステップ経過後にセンサが検知しなくなるまで2～6を繰
り返す.
9.本来の目的地に向かって、ポテンシャル法で進行する。
3.1.2仮ゴールの設定
仮ゴールの位置は求めた速度ob，と障害物の座標（2;y）から求める、この二つから100ス
テップ前の障害物を予測し、その中心に仮ゴールを設定する。例えば、obの座標が（5,8）で
ob』が（0.035,0.025）だとした場合，仮ゴールの座標は（5+0.035x（-100），8+0.025x（-100））
の（8.5,10.5）に設定される。また、このときロボットの現在地と目的地を結ぶ線分をTa，
障害物obmobimaを結ぶ線分Opとする。TaとOpのなす角日が限りなく0に近い場合や0
の場合は障害物の進行方向に対して90°回転させた場所に仮ゴールを設定する（図8）.ob。
の成分が「Tu＞0かつ＜0」または「au＜0かつ＞0」の場合は（-30,24）に60を乗じ
たものを障害物の座標に加え、左側に仮ゴールを設定する。これ以外の場合は（30，
ーズ，）と
して同様の作業を行い右側に仮ゴールを設定する。仮ゴールの座標は、先ほどの条件下で
あれば、（5+0.025✕60,5+（-0.035）✕60）の（6.5,7.1）となる。
10
目的地
目的地
op-
Op
Obm
仮ゴール
仮ゴールObm-
0bmz
0bm2
Ta
ロポットの現在地
ロポットの現在地
図8：通常の仮ゴールの設定箇所
図9:TaとOpのなす角が0の場合の仮
ゴールの設定箇所
3.1.3センサの値
動的障害物を安全に回避するためには、障害物から十分距離が離れていた方がよい。そ
のため本研究では、センサの距離を200cm』としてセンサが反応した障書物が動的障物
ならば、ポテンシャル法で回避する。しかし、静的障害物の場合においてセンサ距離が長
すぎると回り込み走行をした後に障害物に回り込むことができなくなる。そこで、検知し
た障害物が静的障害物の場合，センサ距離を70lcm］として動かすように設定した。
3.2提案手法のアルゴリズム
提案手法のアルゴリズムは以下の通りである。
1．ポテンシャル法で目的地に向かわせる
2．ポテンシャル法で走行中にロボットの2つのセンサが動的障害物を検知した場合、そ
の障害物が動的障害物なら3へ，そうでなければ6へ
3.速度推定を用いて、動的障害物の予測を行う
4.TaとOpのなす角日が0に限りなく近いか0の場合は5へそうでなければ6へ
5.障害物の進行方向に対して90°回転した場所に仮ゴールを設定し、7へ
11
6.障害物の進行方向とは逆に仮ゴールを設定し、7へ
7.仮ゴールを設定し、そこに向かってポテンシャル法で進行する
8.仮ゴールに到着するか、30ステップたちセンサが反応しなくなるか本来の目的地に
向かって、ポテンシャル法で進行し、11へ
9．センサの距離を70lcm』に設定し、障物を認識するまで直進する
10．壁沿い走行で障害物を回避し、センサの値を200cm』に設定し直す
11.ロボットがゴール地点に到達できていれば終了する







4シミュレーション
センサのみを組み込んだポテンシャル法と従来研究18］，提案手法のシミュレーションを
実施し、比較する。動的障害物（縦、横21cml）が縦、横、斜めに移動するものを考え、障
害物の速度は1ステップ当たり縦方向に移動の場合（0，-0.035），横方向の場合（0.035,0）、斜
め方向の場合は（0.035,0.035）に移動しているものとする。シミュレーションマップはス
タート地点を青丸、目的地を赤丸とし、提案手法の仮ゴールは緑丸で表す。黒線は障害物
を表しており、青の太線は障書物の予測位置，青線はロボットの軌道を示している。
4.1シミュレーション結果と比較
動的障害物の進行方向が縦、横、斜めの場合のシミュレーション結果はそれぞれ10～12
に示す。①～④は時間の進みを表している。
②
ロジットの提任え
③④
（a）提案手法（b）センサのみのポテンシャル法
②
（c）従来研究18］の動的障害物回避の結果
図10：縦方向に進行する障害物の回避
13
①②①②
③
（a）提案手法
：①②
（b）センサのみのポテンシャル法
“③
（c）従来研究【8］の動的障害物回避の結果
図11：横方向に進行する障害物の回避
図10（c）の従来手法［8】では、②～③で回避はできているものの障害物に対して近づきす
ぎており障害物の速度によっては衝突する可能性がある。また，図10（6）のセンサのみのポ
テンシャル法では回避する際に一度戻るような動作をしており経路が冗長してしまってい
る．それらに対して図10（a）提案手法では、障害物から離れた距離で回避できており、戻
るような動作も発生していないことから安全で効率よく障害物を回避できている。
障害物が横方向に移動する場合，従来手法「8」では③の時点でロボットと障害物が衝突
してしまっている（図11（a））・図11（6）のセンサのみのポテンシャル法でも障害物の進行方
向にロボットが進んでしまい危険である。それに対して，図11（a）の提案手法では障書物
の進行方向を避けることにより安全な障害物回避を行うことができている。
図12（c）では図11と同様に，従来手法18」では③でロボットと障害物が突してしまっ
ており回避に失敗してしまっている．図12（6）のセンサのみのポテンシャル法でも障害物
の進行方向にロボットが進んでしまい危険である。それに対して、図12（a）の提案法で
14
②②
（a）提案手法
①②
パイナリを煮サ（b）センサのみのポテンシャル法
ソッド
③
（c）従来研究18］の動的障害物回避の結果
図12：斜め方向に進行する障害物の回避
は障害物の進行方向を避けることにより安全な障害物回避を行うことができている。
4.2静的障害物と動的障害物の回避
図13,14では、静的障物と動的障物が同じマップ上にあったときのシミュレーショ
ン結果を示している。このとき、図13の動的障害物は図11で使用したものと同じ横方向
に動く障書物とし、静的障書物をゴール前に設置する、図14では図12で使用した斜め方向
に動く障害物を使用し、静的障害物を開始位置付近に設置した場合を示す。静的障物は
黒の実線で表す．図13を見ると動的障害物を提案手法で回避した後に従来手法［8］の壁沿
い走行で静的障害物を回避することに成功していることがわかる．図14についても静的障
害物を壁沿い走行18］で回避した後に動的障害物を回避できている。また、障書物を回避し
はじめた位置を見ると、ロボットのセンサ距離が変更されており、それによってどちらも
安全に回避できていることがわかる。
15
バイナリム有少①②
パイナリを煮ウソッド
③④
図13：動的障害物と静的障害物の回避（1）
①②
図14：動的障害物と静的障害物の回避（2）
16
5結論
本論文では、ポテンシャル法に速度推定を組み込んだ手法を提案した。静的障書物を回
避するための壁沿い走行に加えて、動的障害物回避のために障書物の座標から速度推定を
行い、数後の障害物の位置を予測するとともに障物の進行方向とは別の位置に仮ゴー
ルを設置した。実際、シミュレーションにおいて、壁沿い走行やセンサのみのポテンシャ
ル法に比べて障害物に接近しすぎず、障害物の進行方向を避ける経路を推定した動的障害
物の速度から仮ゴールを設定することによって、障害物を安全に回避する経路を適切に形
成することが確認できた。また、従来研究」との切り替えることにより動的障害物と静的
障害物が両方ある環境でも障害物を回避する経路生成を行えることを確認した。
以上のことから、提案手法ではロボットが動的障書物に衝突したり、追従したりするこ
となく目的地に到達できており、安全に動的障物を回避するという目的を達成すること
ができた。また、従来研究18」と組み合わせることによって動的障害物と静的障害物が混在
している環境にも柔軟に適応し、目的地に到達させる経路生成を行うことができた。この
ことから、本論文では提案した動的障物の速度推定手法は、障害物回避に有効であるこ
とを示すことができた。ただし、本研究はシミュレーションのみで示しており、実機では
行っていないため、今後検証する必要がある、また，本研究で動的障害物を決まった形の
1つのみを対象としているが、その他の形状の障害物であったり、複数の動的障物での
対策などを考慮する必要がある。ロボットについても速度や形状によって回避できる距離
がどのように変化するかを検証するとともに、障書物回避の際に今後の課題である





参考文献
［第9回自動走行ロボットを活用した配送の実現に向けた官民協議会資料3
2024https://www.meti.go.jp/shingikai/mono_info_service/jidosoko_robot/
pdf/009_03_00.pdf
12青柳誠司、佐藤伸仁、山本恭輝、高橋智一
、鈴木昌人，”移動ロボットの移動
障害物回避に関するファジィルールの学習ポテンシャル法，強化学習法との比較，”シ
ステム制情報学会論文誌，vol.34，nO.8，PP.209-218，2021.
(3]NgangbamHerojitSinghandKhelchandraThongam,"Neuralnetwork-basedap-
proachesformobilerobotnavigationinstaticandmovingobstaclesenvironments,"
IntelligentServiceRobotics12.1(2019):55-67.Web.https://doi.org/10.1007/s11370-
018-0260-2.
14］竹中駿翼、”複数台ロボットに対応した譲り合い経路生成”東京都市大学自動制研
究室2018年度卒業論文，2018.
(5)Qingfeng.Yao,Zeyu.Zheng,Liang.Qi,Haitao.Yuan,Xiwang.Guo,Ming.Zhao,Zhi.
Liu,Tianji.Yang,"Pathplanningmethodwithimprovedartificialpotentialfield—a
reinforcementlearningperspective,"IEEEAccess,vol.8,pp.135513-135523,2020.
(6)Xing.Yang,Wei.Yang,Huijuan.Zhang,Hao.Chang,Chin-Yin.Chen,andShuangchi.
Zhang,"Anewmethodforrobotpathplanningbasedartificialpotentialfield,"2016
IEEE11thConferenceonIndustrialElectronicsandApplications(ICIEA),pp.1294-
1299,2016.
17】平岡翔，”ポテンシャル法における停留問題の回避および効率的な経路生成法，”
東京都市大学自動制御研究室2022年度卒業論文、2022.
181籾山剛輝、”壁沿い走行を組み込んだ仮想ゴールポイントに基づくポテンシャル法によ
る停留と障害物回避、”東京都市大学自動制研究室2021年度卒業論文、2021.
19
19小池基也，”A*探索法を組み込んだ静止障害物に対するポテンシャル法の回避方法”
東京都市大学自動制御研究室2023年度卒業論文，2023.
（10］彌城祐亮、江口和，岩崎聡山内由章、中田昌宏，“ポテンシャル法による口
ボット製品の障害物回避技術の開発，”新製品・新技術特集三菱重工技法，vol.51，
no.1,pp.40-45,2014.